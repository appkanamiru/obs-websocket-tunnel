(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{405:(e,t,r)=>{"use strict";r.d(t,{default:()=>p});var n=r(5155),s=r(5948),l=r(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),c=e=>{let t=o(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},u=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let g=(0,l.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:c,iconNode:g,...h}=e;return(0,l.createElement)("svg",{ref:t,...d,width:n,height:n,stroke:r,strokeWidth:a?24*Number(s)/Number(n):s,className:i("lucide",o),...!c&&!u(h)&&{"aria-hidden":"true"},...h},[...g.map(e=>{let[t,r]=e;return(0,l.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),h=(e,t)=>{let r=(0,l.forwardRef)((r,n)=>{let{className:s,...o}=r;return(0,l.createElement)(g,{ref:n,iconNode:t,className:i("lucide-".concat(a(c(e))),"lucide-".concat(e),s),...o})});return r.displayName=c(e),r},f=h("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),v=h("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),m=h("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function p(){let{obsStatus:e,agentStatus:t}=(0,s.e)();return(0,n.jsxs)("div",{className:"flex flex-col w-56",children:[(0,n.jsx)(x,{status:e,type:"OBS"}),(0,n.jsx)(x,{status:t,type:"Agent"})]})}function x(e){let{status:t,type:r}=e;return(0,n.jsxs)("div",{className:"flex gap-2",children:["connecting"===t?(0,n.jsx)(f,{className:"text-blue-500 animate-spin"}):"connected"===t?(0,n.jsx)(v,{className:"text-green-500"}):(0,n.jsx)(m,{className:"text-red-500"}),(0,n.jsxs)("div",{children:[r," ",t]})]})}},1163:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(5155),s=r(2115),l=r(2596);function a(e){let{label:t,name:r,type:a,value:o,defaultValue:c,size:i,maxLength:u,helperText:d,required:g,disabled:h,error:f,labelBgColor:v="bg-white",onChange:m}=e,p=(0,s.useRef)(null),[x,b]=(0,s.useState)(!1);return(0,n.jsxs)("div",{className:(0,l.A)("w-min mt-2",{"opacity-40":h}),children:[(0,n.jsxs)("div",{onClick:()=>{var e;return null==(e=p.current)?void 0:e.focus()},className:(0,l.A)("transition rounded relative p-3",{"outline-2":x,"outline-1":!x,"outline-red-600":f,"outline-blue-500":!f&&x,"outline-gray-500":!f&&!x,"cursor-pointer":!h,"cursor-not-allowed":h}),children:[(0,n.jsx)("label",{className:(0,l.A)("transition absolute px-1",{"text-red-600":f,"text-blue-500":!f&&x,"text-gray-500":!f&&!x,"translate-x-6":!x&&(void 0===o||(null==o?void 0:o.length)===0),["".concat(v," -translate-y-5.5 text-xs")]:x||void 0!==o&&0!==o.length,"cursor-pointer":!h,"cursor-not-allowed":h}),children:t}),(0,n.jsx)("input",{ref:p,name:r,type:a,value:o,defaultValue:c,size:i,required:g,disabled:h,maxLength:u,onChange:e=>null==m?void 0:m(e.currentTarget.value),onFocus:()=>b(!0),onBlur:()=>b(!1),className:(0,l.A)("outline-none transition",{"cursor-pointer":!h,"cursor-not-allowed":h})})]}),(0,n.jsxs)("div",{className:"flex justify-between px-2 text-xs h-4 mt-1",children:[(0,n.jsx)("div",{className:(0,l.A)({"text-red-600":f,"text-gray-500":!f}),children:d}),(0,n.jsxs)("div",{className:(0,l.A)("text-gray-500",{hidden:void 0===u}),children:[null==o?void 0:o.length," / ",u]})]})]})}},2372:(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var n=r(5155),s=r(2115);function l(){let[e,t]=(0,s.useState)("");return(0,s.useEffect)(()=>{let e=new URL(location.href);3===e.hostname.split(".").length&&t(e.hostname.split(".")[0])},[]),(0,n.jsxs)("h1",{className:"text-2xl self-center",children:["OBS agent - ",e]})}},2596:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=function e(t){var r,n,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t)if(Array.isArray(t)){var l=t.length;for(r=0;r<l;r++)t[r]&&(n=e(t[r]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}(e))&&(n&&(n+=" "),n+=t);return n}},3915:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(5155),s=r(2596);function l(e){let{label:t="",disabled:r=!1,icon:l,bgColor:a="bg-white",textColor:o="text-gray-950",onClick:c}=e;return(0,n.jsxs)("button",{onClick:r?void 0:c,disabled:r,className:(0,s.A)("rounded-full px-2 py-1 text-base shadow-sm font-semibold w-full transition outline-none",a,o,{"opacity-40 cursor-not-allowed":r,"hover:brightness-90 cursor-pointer":!r}),children:[l&&(0,n.jsx)("div",{children:(0,n.jsx)(l,{})}),(0,n.jsx)("div",{children:t})]})}},4829:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var n=r(5155),s=r(5948),l=r(2115),a=r(1163),o=r(3915),c=r(7730);function i(){let{agentToken:e,agentEndpoint:t,saveAgentToken:r,saveAgentEndpoint:i}=(0,s.e)(),[u,d]=(0,l.useState)(""),[g,h]=(0,l.useState)(""),f=(0,l.useCallback)(e=>{e.preventDefault(),r(u),i(g)},[g,u,i,r]);return(0,l.useEffect)(()=>{d(e),h(t)},[t,e]),(0,n.jsxs)("form",{onSubmit:f,className:"flex flex-col items-center gap-2",children:[(0,n.jsx)("h2",{className:"text-lg",children:"Agent details"}),(0,n.jsxs)("div",{children:[(0,n.jsx)(a.A,{value:u,onChange:d,label:"Token",error:0===u.length,helperText:0===u.length?"Invalid token":void 0}),(0,n.jsx)(a.A,{value:g,onChange:h,error:!(0,c.r)(g),helperText:(0,c.r)(g)?void 0:"Invalid endpoint",label:"Endpoint"})]}),(0,n.jsx)(o.A,{disabled:u===e&&g===t||0===u.length||!(0,c.r)(g),label:"Save",bgColor:"bg-emerald-400"})]})}},5948:(e,t,r)=>{"use strict";r.d(t,{default:()=>c,e:()=>i});var n=r(5155),s=r(2115),l=r(7730);let a={password:"",port:"4455",agentToken:"",agentEndpoint:"ws://localhost:9090",obsStatus:"disconnected",agentStatus:"disconnected",savePassword:()=>{},savePort:()=>{},saveAgentToken:()=>{},saveAgentEndpoint:()=>{}},o=(0,s.createContext)(a);function c(e){let{children:t}=e,[r,c]=(0,s.useState)(a.password),[i,u]=(0,s.useState)(a.port),[d,g]=(0,s.useState)(a.agentToken),[h,f]=(0,s.useState)(a.agentEndpoint),[v,m]=(0,s.useState)(a.obsStatus),[p,x]=(0,s.useState)(a.agentStatus),b=(0,s.useRef)(!1),w=(0,s.useRef)(null),S=(0,s.useRef)(null),k=(0,s.useRef)(void 0),j=(0,s.useRef)(void 0),E=(0,s.useCallback)(()=>{var e;clearInterval(j.current),null==(e=S.current)||e.close(),S.current=null,clearInterval(j.current)},[]),y=(0,s.useCallback)(()=>{if(E(),0===d.length||!(0,l.r)(h))return;x("connecting");let e=new WebSocket("".concat(h,"?token=").concat(d));e.addEventListener("open",()=>{console.log("SERVER open"),clearInterval(j.current),S.current=e,x("connected")}),e.addEventListener("error",()=>{console.log("SERVER error")}),e.addEventListener("close",e=>{console.log("SERVER close",e.code,e.reason),S.current=null,j.current=setTimeout(()=>{y()},5e3),x("disconnected")}),e.addEventListener("message",e=>{var t;console.log("SERVER message"),null==(t=w.current)||t.send(e.data)})},[h,d,E]),N=(0,s.useCallback)(()=>{var e;E(),clearTimeout(k.current),null==(e=w.current)||e.close(),w.current=null,clearTimeout(k.current)},[E]),C=(0,s.useCallback)(()=>{N(),m("connecting");let e=new WebSocket("ws://localhost:".concat(i));e.addEventListener("open",()=>{console.log("OBS open"),clearTimeout(k.current),w.current=e}),e.addEventListener("error",()=>{console.log("OBS error")}),e.addEventListener("close",e=>{console.log("OBS close",e.code,e.reason),N(),k.current=setTimeout(()=>{C()},5e3),m("disconnected")}),e.addEventListener("message",t=>{let r;console.log("OBS message");try{r=function(e){let t;try{t=JSON.parse(e)}catch(e){throw Error("Invalid JSON")}if("object"!=typeof t||null===t)throw Error("Invalid message");let{op:r,d:n}=t;if(!("number"==typeof r&&[0,1,2,3,5,6,7,8,9].includes(r)))throw Error("Invalid op code");return{op:r,d:n}}(t.data)}catch(e){return}switch(r.op){case 0:e.send(JSON.stringify(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{op:1,d:{rpcVersion:e}}}()));break;case 2:y(),m("connected");break;case 5:case 7:var n;null==(n=S.current)||n.send(t.data)}})},[y,N,i]),A=(0,s.useCallback)(e=>{localStorage.setItem("obsPassword",e),c(e)},[]),R=(0,s.useCallback)(e=>{localStorage.setItem("obsPort",e),u(e)},[]),I=(0,s.useCallback)(e=>{localStorage.setItem("agentToken",e),g(e)},[]),T=(0,s.useCallback)(e=>{localStorage.setItem("agentEndpoint",e),f(e)},[]);(0,s.useEffect)(()=>{let e=localStorage.getItem("obsPassword")||a.password,t=localStorage.getItem("obsPort")||a.port,r=localStorage.getItem("agentToken")||a.agentToken,n=localStorage.getItem("agentEndpoint")||a.agentEndpoint;c(e),u(t),g(r),f(n),b.current=!0},[]),(0,s.useEffect)(()=>{b.current&&C()},[C]);let L=(0,s.useMemo)(()=>({password:r,port:i,agentToken:d,obsStatus:v,agentStatus:p,agentEndpoint:h,savePassword:A,savePort:R,saveAgentToken:I,saveAgentEndpoint:T}),[h,p,d,v,r,i,T,I,A,R]);return(0,n.jsx)(o.Provider,{value:L,children:t})}function i(){let e=(0,s.useContext)(o);if(!e)throw Error("useObs must be use within ObsProvider");return e}},6580:(e,t,r)=>{Promise.resolve().then(r.bind(r,4829)),Promise.resolve().then(r.bind(r,2372)),Promise.resolve().then(r.bind(r,405)),Promise.resolve().then(r.bind(r,8552))},7730:(e,t,r)=>{"use strict";function n(e){let t=Number(e);return/^\d+$/.test(e)&&t>=0&&t<=65535}function s(e){try{let t=new URL(e),r="ws:"===t.protocol||"wss:"===t.protocol,s=!!t.hostname,l=""===t.port||n(t.port);return r&&s&&l}catch(e){return!1}}r.d(t,{Q:()=>n,r:()=>s})},8552:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var n=r(5155),s=r(5948),l=r(3915),a=r(2115),o=r(1163),c=r(7730);function i(){let{password:e,port:t,savePort:r,savePassword:i}=(0,s.e)(),[u,d]=(0,a.useState)(""),[g,h]=(0,a.useState)(""),f=(0,a.useCallback)(e=>{e.preventDefault(),r(g),i(u)},[u,g,i,r]);return(0,a.useEffect)(()=>{d(e),h(t)},[e,t]),(0,n.jsxs)("form",{onSubmit:f,className:"flex flex-col items-center gap-2",children:[(0,n.jsx)("h2",{className:"text-lg",children:"OBS details"}),(0,n.jsxs)("div",{children:[(0,n.jsx)(o.A,{value:g,onChange:h,error:!(0,c.Q)(g),helperText:(0,c.Q)(g)?void 0:"Invalid port",label:"Port"}),(0,n.jsx)(o.A,{value:u,onChange:d,label:"Password"})]}),(0,n.jsx)(l.A,{disabled:u===e&&g===t||!(0,c.Q)(g),label:"Save",bgColor:"bg-emerald-400"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(6580)),_N_E=e.O()}]);